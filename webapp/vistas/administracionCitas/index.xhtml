<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:b="http://bootsfaces.net/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="/layouts/template.xhtml">
    <ui:define name="content">
        <b:container fluid="true">
            <b:panel title="Panel de control de citas - " largeScreen="8" collapsible="false">
                <f:facet name="heading">
                    <i class="fa fa-calendar-o" style="padding-right:20px" />
                    <b:badge style="margin-left:10px; background-color:#e74c3c" value="#{adminlogin.strCurrentLabelArea}" ></b:badge>
                </f:facet>
                <b:container styleClass="panel-body" fluid="true">
                    <b:tabView activeIndex="0">
                        <b:tab title="Calendario">
                            <b:container styleClass="content" style="padding:15px; margin-bottom:15px;">
                                <b:row>
                                    <b:column style="text-align: center;" span="8">
                                        <h3>
                                            Bienvenido
                                            <h:outputText style="font-weight: bold" value="#{adminlogin.strUsuario}"></h:outputText>
                                             - <h:outputText value="#{adminlogin.strCurrentLabelArea}"></h:outputText>
                                        </h3>
                                    </b:column>
                                    <b:column span="4">
                                        <h:outputText value="No. citas agendadas: "></h:outputText>
                                        <b:badge value="#{ admin.numCitas}"></b:badge>
                                    </b:column>
                                </b:row>
                            </b:container>
                          <h:form>
                                  <b:fullCalendar lang="#{admin.strlang}"
                                                  id="calendariocitas"
                                                  events="#{admin.toJson()}"
                                                  defaultView="agendaWeek"
                                                  eventClick="
                                            function(calEvent, jsEvent, view){
                                                $(this).css('background', 'red');
                                                console.log(calEvent, jsEvent, view);
                                            }"
                                                  weekends="false">
                                  </b:fullCalendar>
                          </h:form>
                        </b:tab>
                        <b:tab title="Reportes">
                            <h:form id="reportesform">
                                <b:row>
                                    <b:column mediumScreen="6" smallScreen="12" largeScreen="6">
                                        <b:formGroup>
                                            <span class="separador"></span>
                                            <b:container style="padding:25px">
                                                <h:outputText value="#{msj['citas.admin.leyeda.reportes.title']}"></h:outputText>
                                            </b:container>
                                            <span class="separador"></span>
                                            <!-- SELECT ONE MENU de los tipos de reportes -->
                                            <b:selectOneMenu value="#{admin.strkindTramite}"
                                                             colMd="12" colLg="12" colSm="12"
                                                             id="selectReporte"
                                                             label="#{msj['citas.admin.leyenda.reportes.combo.tramites']}"
                                                             labelColLg="12"
                                                             ajax="true"
                                                             update="reportesform">

                                                <f:selectItem itemLabel="Seleccione su reporte" value="none" itemValue="none"></f:selectItem>
                                                <f:selectItems value="#{admin.getListKindReportes()}"></f:selectItems>

                                                <f:ajax
                                                        event="change"
                                                        listener="#{admin.listerpostReporte}">
                                                </f:ajax>
                                            </b:selectOneMenu>
                                        </b:formGroup>
                                    </b:column>
                                    <b:column mediumScreen="6" largeScreen="6" smallScreen="12">
                                        <span class="separador"></span>
                                        <b:formGroup id="trami" rendered="#{admin.hasDataTramites}">
                                            <!--               COMBO DE TRAMITES             -->
                                            <b:row>
                                                <b:selectOneMenu value="#{admin.strCurrentTramite}"
                                                                 colMd="12" colLg="12" colSm="12"
                                                                 id="selectTramite"
                                                                 labelStyle="text-aling:left;"
                                                                 label="#{msj['citas.admin.leyenda.reporetes.combo.tramites.option']}"
                                                                 labelColLg="12"
                                                                 ajax="true"
                                                                 rendered="#{admin.hasDataTramites}"
                                                                 required="true"
                                                                 update="@form"
                                                >
                                                    <f:selectItem itemLabel="Seleccione un trámite" value="none" itemValue="none"/>
                                                    <f:selectItems value="#{admin.listTramites}"/>

                                                    <f:ajax
                                                            event="change" listener="#{admin.listenergetnameTramite}">
                                                    </f:ajax>
                                                </b:selectOneMenu>
                                            </b:row>
                                        </b:formGroup>
                                        <b:formGroup rendered="#{admin.hasComboStatus}">
                                            <b:row>
                                                <b:selectOneMenu value="#{admin.strCurrentEstatus}"
                                                                 colMd="12" colLg="12" colSm="12"
                                                                 id="selectEstatus"
                                                                 labelStyle="text-aling:left;"
                                                                 label="#{msj['citas.admin.leyenda.reportes.combo.status']}"
                                                                 labelColLg="12"
                                                                 ajax="true"
                                                                 rendered="#{admin.hasComboStatus}"
                                                                 required="true"
                                                                 update="@form"
                                                >
                                                    <f:selectItem itemLabel="Seleccione un estatus" value="none" itemValue="none"/>
                                                    <f:selectItems value="#{admin.listEstatus}"/>
                                                </b:selectOneMenu>
                                            </b:row>
                                        </b:formGroup>

                                        <b:formGroup rendered="#{admin.hasComboMes}">
                                            <b:row>
                                                <b:selectOneMenu value="#{admin.strCurrentMes}"
                                                                 colMd="12" colLg="12" colSm="12"
                                                                 id="selectMes"
                                                                 labelStyle="text-aling:left;"
                                                                 label="#{msj['citas.admin.leyenda.repores.combo.mes']}"
                                                                 labelColLg="12"
                                                                 ajax="true"
                                                                 required="true"
                                                                 update="@form"
                                                >
                                                    <f:selectItem itemLabel="Seleccione un mes" value="none" itemValue="none"/>
                                                    <f:selectItems value="#{admin.listMeses}"/>
                                                </b:selectOneMenu>
                                            </b:row>
                                        </b:formGroup>
                                        <b:formGroup rendered="#{admin.isrequired}">
                                            <b:container>
                                                <h:outputLabel value="#{msj['citas.admin.leyenda.reportes.combo.fechaSelect']} :"></h:outputLabel>
                                            </b:container>
                                            <b:row>
                                                <b:dateTimePicker value="#{admin.strValueDateFieldA}"
                                                              showTime="false"
                                                              labelColMd="12" labelColLg="12"
                                                              label="Limite de fecha A: " required="#{admin.isrequired}"
                                                              mediumScreen="8" labelMediumScreen="12" largeScreen="10" smallScreen="12">
                                                </b:dateTimePicker>
                                            </b:row>
                                            <b:row>
                                                <b:dateTimePicker value="#{admin.strValueDateFieldB}"
                                                              showTime="false"
                                                              labelColMd="12" labelColLg="12"
                                                              label="Limite de fecha B: " required="#{admin.isrequired}"
                                                              mediumScreen="8" labelMediumScreen="12" largeScreen="10" smallScreen="12">
                                                </b:dateTimePicker>
                                            </b:row>
                                        </b:formGroup>
                                    </b:column>
                                </b:row>
                                <span class="separador"></span>
                                <b:row>
                                    <b:column largeScreen="9" smallScreen="12" mediumScreen="9"></b:column>
                                    <b:column largeScreen="3" mediumScreen="3" smallScreen="12">
                                        <b:commandButton actionListener="#{admin.generarReporte()}" value="Generar Reporte" icon="file"></b:commandButton>
                                    </b:column>
                                </b:row>
                            </h:form>
                        </b:tab>
                        <b:tab title="Configuraciones">
                            <f:facet name="anchor"><b:iconAwesome name="cog" spin="true" /></f:facet>
                            <h:form>
                                <b:row>
                                    <b:panel title="Configura el area" collapsed="true">
                                        <b:column mediumScreen="12" smallScreen="12" largeScreen="12">
                                            <b:container style="padding:25px;">
                                                <h:outputText styleClass="title" style="font-size: 15px;" value="#{msj['citas.admin.leyenda.confighorario.title']}"></h:outputText>
                                            </b:container>
                                            <span class="separador"></span>
                                            <b:formGroup>
                                                <b:row>
                                                    <b:column mediumScreen="4" largeScreen="4" smallScreen="12">
                                                        <b:inputText value="#{admin.strHourServiceStar}" placeholder="8:00"
                                                                     update="@form:**:btnsaveconfiga"
                                                                     tooltip="#{msj['citas.admin.leyenda.confighorario.tooltip.inicio']}">
                                                            <f:facet name="prepend">
                                                                <h:outputText value="Inicio:"></h:outputText>
                                                                <b:iconAwesome name="fa-clock-o"></b:iconAwesome>
                                                            </f:facet>
                                                            <f:facet name="append">
                                                                <h:outputText value="horas" />
                                                            </f:facet>
                                                        </b:inputText>
                                                    </b:column>
                                                    <span class="separador"></span>
                                                    <b:column mediumScreen="4" largeScreen="4" smallScreen="12">
                                                        <b:inputText value="#{admin.strHourServiceEnd}" update="@form:**:btnsaveconfiga" placeholder="13:00"
                                                                     tooltip="#{msj['citas.admin.leyenda.confighorario.tooltip2.fin']}">
                                                            <f:facet name="prepend">
                                                                <h:outputText value="Cierre:"></h:outputText>
                                                                <b:iconAwesome name="fa-clock-o"></b:iconAwesome>
                                                            </f:facet>
                                                            <f:facet name="append">
                                                                <h:outputText value="horas" />
                                                            </f:facet>
                                                        </b:inputText>
                                                    </b:column>
                                                    <span class="separador"></span>
                                                    <b:column mediumScreen="4" largeScreen="4" smallScreen="12">
                                                        <b:inputText value="#{admin.strDuracionCita}" placeholder="20 min"
                                                                     update="@form:**:btnsaveconfiga"
                                                                     tooltip="#{msj['citas.admin.leyenda.confighorario.tooltip']}">
                                                            <f:facet name="prepend">
                                                                <h:outputText value="Duración:"></h:outputText>
                                                                <b:iconAwesome name="fa-clock-o"></b:iconAwesome>
                                                            </f:facet>
                                                            <f:facet name="append">
                                                                <h:outputText value="min" />
                                                            </f:facet>
                                                        </b:inputText>
                                                    </b:column>
                                                </b:row>
                                            </b:formGroup>
                                            <span class="separador"></span>
                                            <span class="separador"></span>
                                            <span class="separador"></span>
                                            <b:formGroup>
                                                <b:row>
                                                    <b:column mediumScreen="6" largeScreen="6" smallScreen="12">
                                                        <b:commandButton action="#{admin.saveDataA()}" id="btnsaveconfiga" disabled="#{admin.validButtonSaveConfig()}" value="Guardar configuración"></b:commandButton>
                                                    </b:column>
                                                </b:row>
                                            </b:formGroup>
                                            <span class="separador"></span>
                                            <span class="separador"></span>
                                            <span class="separador"></span>
                                        </b:column>
                                    </b:panel>
                                </b:row>
                                <b:row>
                                    <b:panel title="Fechas de servicio" collapsed="true">
                                        <b:formGroup>
                                            <b:container style="padding:25px;">
                                                <h:outputText styleClass="title" style="font-size: 15px;" value="#{msj['citas.admin.leyenda.fechasservicio.title']}"></h:outputText>
                                            </b:container>
                                            <span class="separador"></span>
                                            <span class="separador"></span>
                                            <b:row>
                                                <b:column mediumScreen="8" largeScreen="8" smallScreen="8">
                                                    <b:dateTimePicker
                                                            id="datepicker"
                                                            weekDaysDisabled="[0,6]"
                                                            format="MM/DD/YYYY"
                                                            colMd="12" colLg="12" colSm="12"
                                                            mediumScreen="12" labelMediumScreen="12"
                                                            value="#{admin.strCalendarValue}"
                                                            showTime="false"
                                                            disabledDates="#{admin.strDateDisablesCalendar}"
                                                            tooltip="#{msj['citas.admin.leyenda.fechasservicio.timepiker.tootip']}"
                                                            labelColMd="12" labelColLg="12">
                                                    </b:dateTimePicker>
                                                </b:column>
                                                <b:column mediumScreen="1" smallScreen="1" largeScreen="1"></b:column>
                                                <b:column mediumScreen="3" largeScreen="3" smallScreen="3">
                                                    <b:commandButton value="Obtener" update="@form" action="#{admin.RenderDaysToCalendar()}"></b:commandButton>
                                                </b:column>
                                            </b:row>
                                            <span class="separador"></span>
                                            <span class="separador"></span>
                                            <b:row rendered="#{admin.hasDiastoDisable}">
                                                <b:column mediumScreen="10" smallScreen="12" largeScreen="10">
                                                    <h:outputText styleClass="title text-center" style="font-size: 20px;margin: 15px" value="Fecha seleccionada: #{admin.strCurrentLocalDate}"></h:outputText>
                                                </b:column>
                                                <b:column mediumScreen="2" smallScreen="12" largeScreen="2">
                                                    <b:commandButton value="Desactivar dia" tooltip="" action="#{admin.disableDay()}" iconAwesome="lock"></b:commandButton>
                                                </b:column>
                                            </b:row>
                                            <b:row rendered="#{admin.wasDayDisable}">
                                                <b:column smallScreen="1" mediumScreen="1" largeScreen="12"></b:column>
                                                <b:column mediumScreen="5" largeScreen="5" smallScreen="5" >
                                                    <span class="separador"></span>
                                                    <b:badge value="Horarios disponibles para los usuarios" style="margin:15px;background-color:#5cb85c"></b:badge>
                                                    <span class="separador"></span>
                                                    <ui:repeat value="#{admin.listDaysToCheck}" var="daycalendar">
                                                        <b:column smallScreen="12" largeScreen="12" mediumScreen="12">
                                                            <b:iconAwesome name="fa-clock-o"><h:outputText style="margin-left: 15px;margin-right: 15px" styleClass="secondary-text" value="#{daycalendar}"></h:outputText></b:iconAwesome>
                                                            <b:commandButton icon="pencil"
                                                                             tooltip="#{msj['citas.admin.leyenda.tooltip.fechasservicio.btndelete']}"
                                                                             update="@form" action="#{admin.deletefromlistdays(daycalendar)}">
                                                            </b:commandButton>
                                                        </b:column>
                                                    </ui:repeat>
                                                </b:column>
                                                <b:column smallScreen="1" mediumScreen="1" largeScreen="1">
                                                    <b:row><b:iconAwesome name="fa-angle-double-right"></b:iconAwesome></b:row>
                                                    <b:row><b:iconAwesome name="fa-angle-double-right"></b:iconAwesome></b:row>
                                                    <b:row><b:iconAwesome name="fa-angle-double-right"></b:iconAwesome></b:row>
                                                    <b:row><b:iconAwesome name="fa-angle-double-right"></b:iconAwesome></b:row>
                                                    <b:row><b:iconAwesome name="fa-angle-double-right"></b:iconAwesome></b:row>
                                                    <b:row><b:iconAwesome name="fa-angle-double-right"></b:iconAwesome></b:row>
                                                </b:column>
                                                <b:column mediumScreen="5" largeScreen="5" smallScreen="5">
                                                    <span class="separador"></span>
                                                    <b:badge value="Horarios no disponibles para los usuarios" style="margin:15px;color:white;background-color:#34495e"></b:badge>
                                                    <span class="separador"></span>
                                                    <ui:repeat value="#{admin.listDayswasRemoved}" var="dayremove">
                                                        <b:column smallScreen="12" largeScreen="12" mediumScreen="12">
                                                            <b:iconAwesome name="clock-o"><h:outputText style="margin-left: 15px;margin-right: 15px" styleClass="secondary-text" value=" #{dayremove}"></h:outputText></b:iconAwesome>
                                                            <b:commandButton icon="arrow-left"
                                                                             update="@form"
                                                                             tooltip="#{msj['citas.admin.leyenda.tooltip.fechasservicio.rolback']}"
                                                                             action="#{admin.rollbackday(dayremove)}"></b:commandButton>
                                                        </b:column>
                                                    </ui:repeat>
                                                </b:column>
                                            </b:row>
                                            <span class="separador"></span>
                                        </b:formGroup>
                                    </b:panel>
                                </b:row>
                                <b:row>
                                    <b:panel title="Trámites" collapsed="true">
                                        <b:container style="padding:25px;">
                                            <h:outputText styleClass="title" style="font-size: 15px;"
                                                          value="#{msj['citas.admin.leyenda.tramites.title']}"></h:outputText>
                                        </b:container>
                                        <b:row>
                                            <b:column largeScreen="2" mediumScreen="2" smallScreen="12"></b:column>
                                            <b:column largeScreen="8" smallScreen="8" mediumScreen="8">
                                                <h:outputText styleClass="title" value="Lista de Tramites"></h:outputText>
                                            </b:column>
                                            <b:column mediumScreen="2" largeScreen="2" smallScreen="2">
                                                <b:commandButton  iconAwesome="plus"
                                                                  onclick="$('#modalnuevotramite').modal(); javascript:return false; "
                                                                  value="Agregar">
                                                </b:commandButton>
                                            </b:column>
                                        </b:row>
                                        <span class="separador"></span>
                                        <span class="separador"></span>
                                        <b:row>
                                           <b:column mediumScreen="12" smallScreen="12" largeScreen="12">
                                               <ui:repeat value="#{admin.toListTramites()}" var="tramite">
                                                   <b:container>
                                                       <b:row>
                                                           <b:column mediumScreen="6" largeScreen="6" smallScreen="10">
                                                               <b:iconAwesome name="fa-plug"><h:outputText value="#{tramite.getLabel()}" style="margin-top:15px;margin-bottom: 15px;"></h:outputText></b:iconAwesome>
                                                           </b:column>
                                                           <b:column mediumScreen="6" largeScreen="6" smallScreen="2">
                                                               <b:commandButton iconAwesome="trash-o" update="@form" action="#{admin.borrarTramite(tramite.getValue())}"></b:commandButton>
                                                           </b:column>
                                                       </b:row>
                                                   </b:container>

                                               </ui:repeat>
                                           </b:column>
                                       </b:row>
                                    </b:panel>
                                </b:row>
                            </h:form>
                        </b:tab>
                    </b:tabView>
                </b:container>
            </b:panel>
        </b:container>
        <b:modal id="modalnuevotramite" title="Nuevo trámite" styleClass="modal">
            <b:well>
                <h3>Formulario</h3>
                <h:form>
                    <b:row>
                        <b:column  mediumScreen="12" largeScreen="12" smallScreen="12">
                            <b:inputText
                                         label="Nombre Trámite:"
                                         labelStyle="width:200px;"
                                         value="#{admin.strNombreTramite}"
                                         mediumScreen="12" smallScreen="12" largeScreen="12"
                                         labelColMd="4">
                                <f:facet name="prepend">
                                    <b:iconAwesome name="tag"></b:iconAwesome>
                                </f:facet>
                            </b:inputText>
                        </b:column>
                    </b:row>
                    <b:row>
                        <b:column  mediumScreen="12" largeScreen="12" smallScreen="12">
                            <b:inputText
                                    label="Descripcion Trámite:"
                                    labelStyle="width:200px;"
                                    mediumScreen="12" smallScreen="12" largeScreen="12"
                                    value="#{admin.strDescripcion}"
                                    labelColMd="12">
                                <f:facet name="prepend">
                                    <b:iconAwesome name="list-alt"></b:iconAwesome>
                                </f:facet>
                            </b:inputText>
                        </b:column>
                    </b:row>
                    <b:row>
                        <b:selectBooleanCheckbox span="12" value="#{admin.linkTextArea}" caption="¿Es un dirección de internet?"></b:selectBooleanCheckbox>
                        <b:column mediumScreen="12" largeScreen="12" smallScreen="12" style="margin-top:15px;">
                            <b:inputTextarea value="#{admin.strRequisitos}"
                                             colLg="12" colMd="12" colSm="12"
                                             mediumScreen="12" smallScreen="12" largeScreen="12"
                                             labelStyle="width:200px;"
                                             label="Requisitos trámite: [url o texto] *:">
                            </b:inputTextarea>
                        </b:column>
                    </b:row>
                    <b:row>
                        <b:column mediumScreen="10" largeScreen="10" smallScreen="6"></b:column>
                        <b:column mediumScreen="2" largeScreen="2" smallScreen="6">
                            <b:commandButton value="Guardar" styleClass="btn btn-default" action="#{admin.guardarTramite()}"></b:commandButton>
                        </b:column>
                    </b:row>
                </h:form>
            </b:well>

            <f:facet name="footer">
                <b:button value="Cerrar" look="btn btn-default" dismiss="modal" />
            </f:facet>
        </b:modal>
    </ui:define>
</ui:composition>